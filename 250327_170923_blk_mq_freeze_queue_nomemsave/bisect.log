|0327_170923|cmd=cd /root/linux-next|
|0327_170923|git log eb4bc4b07f66f01618d9cb1aa4eaef59b1188415 check_result:commit eb4bc4b07f66f01618d9cb1aa4eaef59b1188415|
|0327_170923|git log 38fec10eb60d687e30c8c6b5420d86e8149f7557 check_result:commit 38fec10eb60d687e30c8c6b5420d86e8149f7557|
|0327_170923|There was old bisect log:git bisect start
# status: waiting for both good and bad commits
# bad: [eb4bc4b07f66f01618d9cb1aa4eaef59b1188415] Add linux-next specific files for 20250325
git bisect bad eb4bc4b07f66f01618d9cb1aa4eaef59b1188415
# status: waiting for good commit(s), bad commit known
# good: [38fec10eb60d687e30c8c6b5420d86e8149f7557] Linux 6.14
git bisect good 38fec10eb60d687e30c8c6b5420d86e8149f7557
# bad: [7fce4e72b3a632ef0571b6808743f7161eb381d5] Merge branch 'main' of git://git.kernel.org/pub/scm/linux/kernel/git/netdev/net-next.git
git bisect bad 7fce4e72b3a632ef0571b6808743f7161eb381d5
# bad: [8c9d7cef441a1524fda5f897e51170cbdaf7f805] Merge branch 'for-next' of git://git.kernel.org/pub/scm/linux/kernel/git/s390/linux.git
git bisect bad 8c9d7cef441a1524fda5f897e51170cbdaf7f805
# bad: [19a59037028747a7f197d612f496f897512635b3] Merge branch 'for-next' of git://git.kernel.org/pub/scm/linux/kernel/git/masahiroy/linux-kbuild.git
git bisect bad 19a59037028747a7f197d612f496f897512635b3
# good: [829ee558f3527fd602c6e2e9f270959d1de09fe0] ALSA: hda/realtek: Fix built-in mic assignment on ASUS VivoBook X515UA
git bisect good 829ee558f3527fd602c6e2e9f270959d1de09fe0
# good: [87f556baedc9cca2edb318efe9d8cf009d916c4d] mseal sysmap: add arch-support txt
git bisect good 87f556baedc9cca2edb318efe9d8cf009d916c4d
# bad: [e63046adefc03800f1af76476701606bb148b49c] Merge tag 'vfs-6.15-rc1.ceph' of git://git.kernel.org/pub/scm/linux/kernel/git/vfs/vfs
git bisect bad e63046adefc03800f1af76476701606bb148b49c
# good: [df00ded23a6b4df888237333b1f86067d24113b2] Merge tag 'vfs-6.15-rc1.pidfs' of git://git.kernel.org/pub/scm/linux/kernel/git/vfs/vfs
git bisect good df00ded23a6b4df888237333b1f86067d24113b2
# good: [26d8e430796e7e110c656e87be8d9d3d3a90a305] Merge tag 'vfs-6.15-rc1.async.dir' of git://git.kernel.org/pub/scm/linux/kernel/git/vfs/vfs
git bisect good 26d8e430796e7e110c656e87be8d9d3d3a90a305
# good: [130e696aa68b0e0c13f790898529b2cc1a5f8f8e] Merge tag 'vfs-6.15-rc1.mount.namespace' of git://git.kernel.org/pub/scm/linux/kernel/git/vfs/vfs
git bisect good 130e696aa68b0e0c13f790898529b2cc1a5f8f8e
# good: [9dcef93363e7f7b925b3adc4a3171bd00250c8dd] fs: Remove page_mkwrite_check_truncate()
git bisect good 9dcef93363e7f7b925b3adc4a3171bd00250c8dd
# bad: [47dd67532303803a87f43195e088b3b4bcf0454d] block/bdev: lift block size restrictions to 64k
git bisect bad 47dd67532303803a87f43195e088b3b4bcf0454d
# good: [86c60efd7c0ede43bd677f2eee1d84200528df1e] fs/mpage: avoid negative shift for large blocksize
git bisect good 86c60efd7c0ede43bd677f2eee1d84200528df1e
# good: [e59e97d42b053011ca831a9079ae0b6c4b2ecf65] fs/buffer fs/mpage: remove large folio restriction
git bisect good e59e97d42b053011ca831a9079ae0b6c4b2ecf65
# bad: [3c20917120ce61f2a123ca0810293872f4c6b5a4] block/bdev: enable large folio support for large logical block sizes
git bisect bad 3c20917120ce61f2a123ca0810293872f4c6b5a4
# first bad commit: [3c20917120ce61f2a123ca0810293872f4c6b5a4] block/bdev: enable large folio support for large logical block sizes, will clean it|
|0327_170923|cmd=git bisect reset|
|0327_170925|cmd=git checkout -f eb4bc4b07f66f01618d9cb1aa4eaef59b1188415|
|0327_170926|cmd=cd /root/linux-next|
|0327_170926||/var/www/html/bzimage/bzImage_eb4bc4b07f66f01618d9cb1aa4eaef59b1188415| exist, no need make|
|0327_170926|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_170926|Run /var/www/html/bzimage/bzImage_eb4bc4b07f66f01618d9cb1aa4eaef59b1188415 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_170941|It takes 15 seconds to find login:test login: |
|0327_170941|Boot 1 time: takes 15 seconds to boot up.|
|0327_170941|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_170942|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_170943|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_170944|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_170945|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_170955|/var/www/html/bzimage/bzImage_eb4bc4b07f66f01618d9cb1aa4eaef59b1188415 contained blk_mq_freeze_queue_nomemsave:[   18.223799] ffff8880106b3168 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   18.240811]  #1: ffff8880106b3168 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   18.241317]  #2: ffff8880106b31a0 (&q->q_usage_counter(queue)#6){+.+.}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40, FAIL|
|0327_170955|Found time:18 in /var/www/html/bzimage/0327_170923_blk_mq_freeze_queue_nomemsave/eb4bc4b07f66f01618d9cb1aa4eaef59b1188415_dmesg.log|
|0327_170955|Logic: |<=25: +25|25-100 +180|>100 +1800| Set TIME:43|
|0327_170955|-END- commit eb4bc4b07f66f01618d9cb1aa4eaef59b1188415 FAIL bad|
|0327_170955|cmd=rm -rf /var/www/html//syzkaller/2025_03_27/6ca073667b2d5081ea45c701046f6dec3af7e639|
|0327_170955|cmd=mkdir -p /var/www/html//syzkaller/2025_03_27/6ca073667b2d5081ea45c701046f6dec3af7e639|
|0327_170955|cmd=cp -rf /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog /var/www/html//syzkaller/2025_03_27/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.c|
|0327_170955|gcc -pthread /var/www/html//syzkaller/2025_03_27/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.c -o /var/www/html//syzkaller/2025_03_27/6ca073667b2d5081ea45c701046f6dec3af7e639/repro|
|0327_170955|cmd=cp -rf /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/description /var/www/html//syzkaller/2025_03_27/6ca073667b2d5081ea45c701046f6dec3af7e639|
|0327_170955|cp -rf /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/mount_* /var/www/html/bzimage/0327_170923_blk_mq_freeze_queue_nomemsave/|
|0327_170957|wget https://raw.githubusercontent.com/xupengfe/kconfig_diff/main/config-5.18rc4i_kvm -O /var/www/html/bzimage/0327_170923_blk_mq_freeze_queue_nomemsave/kconfig_origin:0|
|0327_170957|cmd=cd /root/linux-next|
|0327_170957||/var/www/html/bzimage/bzImage_38fec10eb60d687e30c8c6b5420d86e8149f7557| exist, no need make|
|0327_170957|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_170957|Run /var/www/html/bzimage/bzImage_38fec10eb60d687e30c8c6b5420d86e8149f7557 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_171011|It takes 14 seconds to find login:test login: |
|0327_171011|Boot 1 time: takes 14 seconds to boot up.|
|0327_171011|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_171012|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_171013|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_171015|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_171015|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_171058|/var/www/html/bzimage/bzImage_38fec10eb60d687e30c8c6b5420d86e8149f7557 didn't contain blk_mq_freeze_queue_nomemsave: in dmesg, pass|
|0327_171058|Start commit 38fec10eb60d687e30c8c6b5420d86e8149f7557 PASS good|
|0327_171058|cmd=git checkout -f eb4bc4b07f66f01618d9cb1aa4eaef59b1188415|
|0327_171058|cmd=git bisect start|
|0327_171058|cmd=git bisect bad eb4bc4b07f66f01618d9cb1aa4eaef59b1188415|
|0327_171058|Bisect first start commit:38fec10eb60d687e30c8c6b5420d86e8149f7557|
|0327_171058|git bisect good 38fec10eb60d687e30c8c6b5420d86e8149f7557|
|0327_171100||/var/www/html/bzimage/bzImage_7fce4e72b3a632ef0571b6808743f7161eb381d5| exist, no need make|
|0327_171100|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_171100|Run /var/www/html/bzimage/bzImage_7fce4e72b3a632ef0571b6808743f7161eb381d5 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_171115|It takes 15 seconds to find login:test login: |
|0327_171115|Boot 1 time: takes 15 seconds to boot up.|
|0327_171115|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_171116|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_171117|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_171119|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_171119|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_171202|/var/www/html/bzimage/bzImage_7fce4e72b3a632ef0571b6808743f7161eb381d5 didn't contain blk_mq_freeze_queue_nomemsave: in dmesg, pass|
|0327_171202|git bisect good 7fce4e72b3a632ef0571b6808743f7161eb381d5|
|0327_171203|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m 8447b0779f1aa7db55d5f249779ba8635aa856e7 -d /var/www/html/bzimage -o /tmp/kernel|
|0327_173226|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_173226|Run /var/www/html/bzimage/bzImage_8447b0779f1aa7db55d5f249779ba8635aa856e7 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_173241|It takes 14 seconds to find login:test login: |
|0327_173241|Boot 1 time: takes 14 seconds to boot up.|
|0327_173241|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_173241|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_173243|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_173244|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_173244|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_173327|/var/www/html/bzimage/bzImage_8447b0779f1aa7db55d5f249779ba8635aa856e7 contained blk_mq_freeze_queue_nomemsave:[   17.895753] ffff88801098e228 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   17.915476]  #1: ffff88801098e228 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   17.916012]  #2: ffff88801098e260 (&q->q_usage_counter(queue)#9){+.+.}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40, FAIL|
|0327_173327|git bisect bad 8447b0779f1aa7db55d5f249779ba8635aa856e7|
|0327_173330|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m 52eb8cd788f1a56a0645c1f6650e5795e04aaed0 -d /var/www/html/bzimage -o /tmp/kernel|
|0327_175410|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_175410|Run /var/www/html/bzimage/bzImage_52eb8cd788f1a56a0645c1f6650e5795e04aaed0 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_175424|It takes 14 seconds to find login:test login: |
|0327_175424|Boot 1 time: takes 14 seconds to boot up.|
|0327_175424|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_175425|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_175426|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_175427|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_175428|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_175511|/var/www/html/bzimage/bzImage_52eb8cd788f1a56a0645c1f6650e5795e04aaed0 didn't contain blk_mq_freeze_queue_nomemsave: in dmesg, pass|
|0327_175511|git bisect good 52eb8cd788f1a56a0645c1f6650e5795e04aaed0|
|0327_175513|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m 985b964c63502e64a45907baf838f98ef4c46660 -d /var/www/html/bzimage -o /tmp/kernel|
|0327_181553|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_181553|Run /var/www/html/bzimage/bzImage_985b964c63502e64a45907baf838f98ef4c46660 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_181608|It takes 15 seconds to find login:test login: |
|0327_181608|Boot 1 time: takes 15 seconds to boot up.|
|0327_181608|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_181609|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_181610|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_181612|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_181612|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_181655|/var/www/html/bzimage/bzImage_985b964c63502e64a45907baf838f98ef4c46660 didn't contain blk_mq_freeze_queue_nomemsave: in dmesg, pass|
|0327_181655|git bisect good 985b964c63502e64a45907baf838f98ef4c46660|
|0327_181657|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m b3f9d748911e6839fe11e48c3a31270eadf7a297 -d /var/www/html/bzimage -o /tmp/kernel|
|0327_183749|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_183749|Run /var/www/html/bzimage/bzImage_b3f9d748911e6839fe11e48c3a31270eadf7a297 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_183804|It takes 15 seconds to find login:test login: |
|0327_183804|Boot 1 time: takes 15 seconds to boot up.|
|0327_183804|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_183805|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_183807|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_183808|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_183808|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_183851|/var/www/html/bzimage/bzImage_b3f9d748911e6839fe11e48c3a31270eadf7a297 contained blk_mq_freeze_queue_nomemsave:[   18.924631] ffff8880109fa7a8 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   18.939038]  #1: ffff8880109fa7a8 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   18.939548]  #2: ffff8880109fa7e0 (&q->q_usage_counter(queue)#7){+.+.}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40, FAIL|
|0327_183851|git bisect bad b3f9d748911e6839fe11e48c3a31270eadf7a297|
|0327_183854|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m 95fb1ce9385b257bcf7bac1933b2d97270713c10 -d /var/www/html/bzimage -o /tmp/kernel|
|0327_185941|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_185941|Run /var/www/html/bzimage/bzImage_95fb1ce9385b257bcf7bac1933b2d97270713c10 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_185957|It takes 16 seconds to find login:test login: |
|0327_185957|Boot 1 time: takes 16 seconds to boot up.|
|0327_185957|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_185958|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_185959|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_190001|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_190001|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_190044|/var/www/html/bzimage/bzImage_95fb1ce9385b257bcf7bac1933b2d97270713c10 contained blk_mq_freeze_queue_nomemsave:[   20.443557] ffff8880108dc4e8 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   20.461188]  #1: ffff8880108dc4e8 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   20.461763]  #2: ffff8880108dc520 (&q->q_usage_counter(queue)#22){+.+.}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40, FAIL|
|0327_190044|git bisect bad 95fb1ce9385b257bcf7bac1933b2d97270713c10|
|0327_190045|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m 5f14404bfa245a156915ee44c827edc56655b067 -d /var/www/html/bzimage -o /tmp/kernel|
|0327_192139|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_192139|Run /var/www/html/bzimage/bzImage_5f14404bfa245a156915ee44c827edc56655b067 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_192153|It takes 14 seconds to find login:test login: |
|0327_192153|Boot 1 time: takes 14 seconds to boot up.|
|0327_192153|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_192154|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_192156|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_192157|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_192157|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_192240|/var/www/html/bzimage/bzImage_5f14404bfa245a156915ee44c827edc56655b067 didn't contain blk_mq_freeze_queue_nomemsave: in dmesg, pass|
|0327_192240|git bisect good 5f14404bfa245a156915ee44c827edc56655b067|
|0327_192242|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m 017ff379b60b98c17b82f878b4eb751dc99eb21c -d /var/www/html/bzimage -o /tmp/kernel|
|0327_194324|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_194324|Run /var/www/html/bzimage/bzImage_017ff379b60b98c17b82f878b4eb751dc99eb21c with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_194338|It takes 14 seconds to find login:test login: |
|0327_194338|Boot 1 time: takes 14 seconds to boot up.|
|0327_194338|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_194339|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_194340|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_194342|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_194342|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_194425|/var/www/html/bzimage/bzImage_017ff379b60b98c17b82f878b4eb751dc99eb21c didn't contain blk_mq_freeze_queue_nomemsave: in dmesg, pass|
|0327_194425|git bisect good 017ff379b60b98c17b82f878b4eb751dc99eb21c|
|0327_194425|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m 64ea88e3afa8c5b6c3f9c477da304b7a56149612 -d /var/www/html/bzimage -o /tmp/kernel|
|0327_200511|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_200511|Run /var/www/html/bzimage/bzImage_64ea88e3afa8c5b6c3f9c477da304b7a56149612 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_200526|It takes 15 seconds to find login:test login: |
|0327_200526|Boot 1 time: takes 15 seconds to boot up.|
|0327_200526|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_200527|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_200528|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_200530|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_200530|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_200613|/var/www/html/bzimage/bzImage_64ea88e3afa8c5b6c3f9c477da304b7a56149612 contained blk_mq_freeze_queue_nomemsave:[   18.825564] ffff8880108dc4e8 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   18.840046]  #1: ffff8880108dc4e8 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   18.840567]  #2: ffff8880108dc520 (&q->q_usage_counter(queue)#6){+.+.}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40, FAIL|
|0327_200613|git bisect bad 64ea88e3afa8c5b6c3f9c477da304b7a56149612|
|0327_200613|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m 9d5c0fffee266f61ccc745faa6298dafe2b8c5bf -d /var/www/html/bzimage -o /tmp/kernel|
|0327_202657|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_202657|Run /var/www/html/bzimage/bzImage_9d5c0fffee266f61ccc745faa6298dafe2b8c5bf with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_202710|It takes 13 seconds to find login:test login: |
|0327_202710|Boot 1 time: takes 13 seconds to boot up.|
|0327_202710|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_202711|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_202712|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_202713|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_202714|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_202757|/var/www/html/bzimage/bzImage_9d5c0fffee266f61ccc745faa6298dafe2b8c5bf contained blk_mq_freeze_queue_nomemsave:[   16.903378] ffff8880109727a8 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   16.917560]  #1: ffff8880109727a8 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   16.918068]  #2: ffff8880109727e0 (&q->q_usage_counter(queue)#17){+.+.}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40, FAIL|
|0327_202757|git bisect bad 9d5c0fffee266f61ccc745faa6298dafe2b8c5bf|
|0327_202757|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m e1a0202c6bfda24002a3ae2115154fa90104c649 -d /var/www/html/bzimage -o /tmp/kernel|
|0327_204909|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_204909|Run /var/www/html/bzimage/bzImage_e1a0202c6bfda24002a3ae2115154fa90104c649 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_204923|It takes 14 seconds to find login:test login: |
|0327_204923|Boot 1 time: takes 14 seconds to boot up.|
|0327_204923|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_204924|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_204926|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_204927|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_204927|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_205010|/var/www/html/bzimage/bzImage_e1a0202c6bfda24002a3ae2115154fa90104c649 contained blk_mq_freeze_queue_nomemsave:[   17.785931] ffff88801097cea8 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   17.802594]  #1: ffff88801097cea8 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   17.803186]  #2: ffff88801097cee0 (&q->q_usage_counter(queue)#3){+.+.}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40, FAIL|
|0327_205010|git bisect bad e1a0202c6bfda24002a3ae2115154fa90104c649|
|0327_205011|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m 0e94ed33681424a6dce65c62837e08e4c7aa09ac -d /var/www/html/bzimage -o /tmp/kernel|
|0327_211045|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_211045|Run /var/www/html/bzimage/bzImage_0e94ed33681424a6dce65c62837e08e4c7aa09ac with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_211059|It takes 14 seconds to find login:test login: |
|0327_211059|Boot 1 time: takes 14 seconds to boot up.|
|0327_211059|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_211100|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_211101|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_211103|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_211103|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_211146|/var/www/html/bzimage/bzImage_0e94ed33681424a6dce65c62837e08e4c7aa09ac didn't contain blk_mq_freeze_queue_nomemsave: in dmesg, pass|
|0327_211146|git bisect good 0e94ed33681424a6dce65c62837e08e4c7aa09ac|
|0327_211146|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m ffa1e7ada456087c2402b37cd6b2863ced29aff0 -d /var/www/html/bzimage -o /tmp/kernel|
|0327_213228|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_213228|Run /var/www/html/bzimage/bzImage_ffa1e7ada456087c2402b37cd6b2863ced29aff0 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_213242|It takes 14 seconds to find login:test login: |
|0327_213242|Boot 1 time: takes 14 seconds to boot up.|
|0327_213242|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_213243|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_213245|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_213246|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_213246|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_213329|/var/www/html/bzimage/bzImage_ffa1e7ada456087c2402b37cd6b2863ced29aff0 contained blk_mq_freeze_queue_nomemsave:[   19.097755] ffff88800ff6cea8 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   19.115767]  #1: ffff88800ff6cea8 (&q->q_usage_counter(io)#20){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40
[   19.116348]  #2: ffff88800ff6cee0 (&q->q_usage_counter(queue)#3){+.+.}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x1f/0x40, FAIL|
|0327_213329|git bisect bad ffa1e7ada456087c2402b37cd6b2863ced29aff0|
|0327_213330|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m b0d42581195603f38184d7c130d0e2f43f40fb33 -d /var/www/html/bzimage -o /tmp/kernel|
|0327_215419|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_215419|Run /var/www/html/bzimage/bzImage_b0d42581195603f38184d7c130d0e2f43f40fb33 with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_215434|It takes 15 seconds to find login:test login: |
|0327_215434|Boot 1 time: takes 15 seconds to boot up.|
|0327_215434|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_215435|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_215436|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_215437|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_215438|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_215521|/var/www/html/bzimage/bzImage_b0d42581195603f38184d7c130d0e2f43f40fb33 didn't contain blk_mq_freeze_queue_nomemsave: in dmesg, pass|
|0327_215521|git bisect good b0d42581195603f38184d7c130d0e2f43f40fb33|
|0327_215521|Bisect PASS: find bad commit: ffa1e7ada456087c2402b37cd6b2863ced29aff0 is the first bad commit
commit ffa1e7ada456087c2402b37cd6b2863ced29aff0
Author: Thomas Hellström <thomas.hellstrom@linux.intel.com>
Date:   Tue Mar 18 10:55:48 2025 +0100

    block: Make request_queue lockdep splats show up earlier
    
    In recent kernels, there are lockdep splats around the
    struct request_queue::io_lockdep_map, similar to [1], but they
    typically don't show up until reclaim with writeback happens.
    
    Having multiple kernel versions released with a known risc of kernel
    deadlock during reclaim writeback should IMHO be addressed and
    backported to -stable with the highest priority.
    
    In order to have these lockdep splats show up earlier,
    preferrably during system initialization, prime the
    struct request_queue::io_lockdep_map as GFP_KERNEL reclaim-
    tainted. This will instead lead to lockdep splats looking similar
    to [2], but without the need for reclaim + writeback
    happening.
    
    [1]:
    [  189.762244] ======================================================
    [  189.762432] WARNING: possible circular locking dependency detected
    [  189.762441] 6.14.0-rc6-xe+ #6 Tainted: G     U
    [  189.762450] ------------------------------------------------------
    [  189.762459] kswapd0/119 is trying to acquire lock:
    [  189.762467] ffff888110ceb710 (&q->q_usage_counter(io)#26){++++}-{0:0}, at: __submit_bio+0x76/0x230
    [  189.762485]
                   but task is already holding lock:
    [  189.762494] ffffffff834c97c0 (fs_reclaim){+.+.}-{0:0}, at: balance_pgdat+0xbe/0xb00
    [  189.762507]
                   which lock already depends on the new lock.
    
    [  189.762519]
                   the existing dependency chain (in reverse order) is:
    [  189.762529]
                   -> #2 (fs_reclaim){+.+.}-{0:0}:
    [  189.762540]        fs_reclaim_acquire+0xc5/0x100
    [  189.762548]        kmem_cache_alloc_lru_noprof+0x4a/0x480
    [  189.762558]        alloc_inode+0xaa/0xe0
    [  189.762566]        iget_locked+0x157/0x330
    [  189.762573]        kernfs_get_inode+0x1b/0x110
    [  189.762582]        kernfs_get_tree+0x1b0/0x2e0
    [  189.762590]        sysfs_get_tree+0x1f/0x60
    [  189.762597]        vfs_get_tree+0x2a/0xf0
    [  189.762605]        path_mount+0x4cd/0xc00
    [  189.762613]        __x64_sys_mount+0x119/0x150
    [  189.762621]        x64_sys_call+0x14f2/0x2310
    [  189.762630]        do_syscall_64+0x91/0x180
    [  189.762637]        entry_SYSCALL_64_after_hwframe+0x76/0x7e
    [  189.762647]
                   -> #1 (&root->kernfs_rwsem){++++}-{3:3}:
    [  189.762659]        down_write+0x3e/0xf0
    [  189.762667]        kernfs_remove+0x32/0x60
    [  189.762676]        sysfs_remove_dir+0x4f/0x60
    [  189.762685]        __kobject_del+0x33/0xa0
    [  189.762709]        kobject_del+0x13/0x30
    [  189.762716]        elv_unregister_queue+0x52/0x80
    [  189.762725]        elevator_switch+0x68/0x360
    [  189.762733]        elv_iosched_store+0x14b/0x1b0
    [  189.762756]        queue_attr_store+0x181/0x1e0
    [  189.762765]        sysfs_kf_write+0x49/0x80
    [  189.762773]        kernfs_fop_write_iter+0x17d/0x250
    [  189.762781]        vfs_write+0x281/0x540
    [  189.762790]        ksys_write+0x72/0xf0
    [  189.762798]        __x64_sys_write+0x19/0x30
    [  189.762807]        x64_sys_call+0x2a3/0x2310
    [  189.762815]        do_syscall_64+0x91/0x180
    [  189.762823]        entry_SYSCALL_64_after_hwframe+0x76/0x7e
    [  189.762833]
                   -> #0 (&q->q_usage_counter(io)#26){++++}-{0:0}:
    [  189.762845]        __lock_acquire+0x1525/0x2760
    [  189.762854]        lock_acquire+0xca/0x310
    [  189.762861]        blk_mq_submit_bio+0x8a2/0xba0
    [  189.762870]        __submit_bio+0x76/0x230
    [  189.762878]        submit_bio_noacct_nocheck+0x323/0x430
    [  189.762888]        submit_bio_noacct+0x2cc/0x620
    [  189.762896]        submit_bio+0x38/0x110
    [  189.762904]        __swap_writepage+0xf5/0x380
    [  189.762912]        swap_writepage+0x3c7/0x600
    [  189.762920]        shmem_writepage+0x3da/0x4f0
    [  189.762929]        pageout+0x13f/0x310
    [  189.762937]        shrink_folio_list+0x61c/0xf60
    [  189.763261]        evict_folios+0x378/0xcd0
    [  189.763584]        try_to_shrink_lruvec+0x1b0/0x360
    [  189.763946]        shrink_one+0x10e/0x200
    [  189.764266]        shrink_node+0xc02/0x1490
    [  189.764586]        balance_pgdat+0x563/0xb00
    [  189.764934]        kswapd+0x1e8/0x430
    [  189.765249]        kthread+0x10b/0x260
    [  189.765559]        ret_from_fork+0x44/0x70
    [  189.765889]        ret_from_fork_asm+0x1a/0x30
    [  189.766198]
                   other info that might help us debug this:
    
    [  189.767089] Chain exists of:
                     &q->q_usage_counter(io)#26 --> &root->kernfs_rwsem --> fs_reclaim
    
    [  189.767971]  Possible unsafe locking scenario:
    
    [  189.768555]        CPU0                    CPU1
    [  189.768849]        ----                    ----
    [  189.769136]   lock(fs_reclaim);
    [  189.769421]                                lock(&root->kernfs_rwsem);
    [  189.769714]                                lock(fs_reclaim);
    [  189.770016]   rlock(&q->q_usage_counter(io)#26);
    [  189.770305]
                    *** DEADLOCK ***
    
    [  189.771167] 1 lock held by kswapd0/119:
    [  189.771453]  #0: ffffffff834c97c0 (fs_reclaim){+.+.}-{0:0}, at: balance_pgdat+0xbe/0xb00
    [  189.771770]
                   stack backtrace:
    [  189.772351] CPU: 4 UID: 0 PID: 119 Comm: kswapd0 Tainted: G     U             6.14.0-rc6-xe+ #6
    [  189.772353] Tainted: [U]=USER
    [  189.772354] Hardware name: ASUS System Product Name/PRIME B560M-A AC, BIOS 2001 02/01/2023
    [  189.772354] Call Trace:
    [  189.772355]  <TASK>
    [  189.772356]  dump_stack_lvl+0x6e/0xa0
    [  189.772359]  dump_stack+0x10/0x18
    [  189.772360]  print_circular_bug.cold+0x17a/0x1b7
    [  189.772363]  check_noncircular+0x13a/0x150
    [  189.772365]  ? __pfx_stack_trace_consume_entry+0x10/0x10
    [  189.772368]  __lock_acquire+0x1525/0x2760
    [  189.772368]  ? ret_from_fork_asm+0x1a/0x30
    [  189.772371]  lock_acquire+0xca/0x310
    [  189.772372]  ? __submit_bio+0x76/0x230
    [  189.772375]  ? lock_release+0xd5/0x2c0
    [  189.772376]  blk_mq_submit_bio+0x8a2/0xba0
    [  189.772378]  ? __submit_bio+0x76/0x230
    [  189.772380]  __submit_bio+0x76/0x230
    [  189.772382]  ? trace_hardirqs_on+0x1e/0xe0
    [  189.772384]  submit_bio_noacct_nocheck+0x323/0x430
    [  189.772386]  ? submit_bio_noacct_nocheck+0x323/0x430
    [  189.772387]  ? __might_sleep+0x58/0xa0
    [  189.772390]  submit_bio_noacct+0x2cc/0x620
    [  189.772391]  ? count_memcg_events+0x68/0x90
    [  189.772393]  submit_bio+0x38/0x110
    [  189.772395]  __swap_writepage+0xf5/0x380
    [  189.772396]  swap_writepage+0x3c7/0x600
    [  189.772397]  shmem_writepage+0x3da/0x4f0
    [  189.772401]  pageout+0x13f/0x310
    [  189.772406]  shrink_folio_list+0x61c/0xf60
    [  189.772409]  ? isolate_folios+0xe80/0x16b0
    [  189.772410]  ? mark_held_locks+0x46/0x90
    [  189.772412]  evict_folios+0x378/0xcd0
    [  189.772414]  ? evict_folios+0x34a/0xcd0
    [  189.772415]  ? lock_is_held_type+0xa3/0x130
    [  189.772417]  try_to_shrink_lruvec+0x1b0/0x360
    [  189.772420]  shrink_one+0x10e/0x200
    [  189.772421]  shrink_node+0xc02/0x1490
    [  189.772423]  ? shrink_node+0xa08/0x1490
    [  189.772424]  ? shrink_node+0xbd8/0x1490
    [  189.772425]  ? mem_cgroup_iter+0x366/0x480
    [  189.772427]  balance_pgdat+0x563/0xb00
    [  189.772428]  ? balance_pgdat+0x563/0xb00
    [  189.772430]  ? trace_hardirqs_on+0x1e/0xe0
    [  189.772431]  ? finish_task_switch.isra.0+0xcb/0x330
    [  189.772433]  ? __switch_to_asm+0x33/0x70
    [  189.772437]  kswapd+0x1e8/0x430
    [  189.772438]  ? __pfx_autoremove_wake_function+0x10/0x10
    [  189.772440]  ? __pfx_kswapd+0x10/0x10
    [  189.772441]  kthread+0x10b/0x260
    [  189.772443]  ? __pfx_kthread+0x10/0x10
    [  189.772444]  ret_from_fork+0x44/0x70
    [  189.772446]  ? __pfx_kthread+0x10/0x10
    [  189.772447]  ret_from_fork_asm+0x1a/0x30
    [  189.772450]  </TASK>
    
    [2]:
    [    8.760253] ======================================================
    [    8.760254] WARNING: possible circular locking dependency detected
    [    8.760255] 6.14.0-rc6-xe+ #7 Tainted: G     U
    [    8.760256] ------------------------------------------------------
    [    8.760257] (udev-worker)/674 is trying to acquire lock:
    [    8.760259] ffff888100e39148 (&root->kernfs_rwsem){++++}-{3:3}, at: kernfs_remove+0x32/0x60
    [    8.760265]
                   but task is already holding lock:
    [    8.760266] ffff888110dc7680 (&q->q_usage_counter(io)#27){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x12/0x30
    [    8.760272]
                   which lock already depends on the new lock.
    
    [    8.760272]
                   the existing dependency chain (in reverse order) is:
    [    8.760273]
                   -> #2 (&q->q_usage_counter(io)#27){++++}-{0:0}:
    [    8.760276]        blk_alloc_queue+0x30a/0x350
    [    8.760279]        blk_mq_alloc_queue+0x6b/0xe0
    [    8.760281]        scsi_alloc_sdev+0x276/0x3c0
    [    8.760284]        scsi_probe_and_add_lun+0x22a/0x440
    [    8.760286]        __scsi_scan_target+0x109/0x230
    [    8.760288]        scsi_scan_channel+0x65/0xc0
    [    8.760290]        scsi_scan_host_selected+0xff/0x140
    [    8.760292]        do_scsi_scan_host+0xa7/0xc0
    [    8.760293]        do_scan_async+0x1c/0x160
    [    8.760295]        async_run_entry_fn+0x32/0x150
    [    8.760299]        process_one_work+0x224/0x5f0
    [    8.760302]        worker_thread+0x1d4/0x3e0
    [    8.760304]        kthread+0x10b/0x260
    [    8.760306]        ret_from_fork+0x44/0x70
    [    8.760309]        ret_from_fork_asm+0x1a/0x30
    [    8.760312]
                   -> #1 (fs_reclaim){+.+.}-{0:0}:
    [    8.760315]        fs_reclaim_acquire+0xc5/0x100
    [    8.760317]        kmem_cache_alloc_lru_noprof+0x4a/0x480
    [    8.760319]        alloc_inode+0xaa/0xe0
    [    8.760322]        iget_locked+0x157/0x330
    [    8.760323]        kernfs_get_inode+0x1b/0x110
    [    8.760325]        kernfs_get_tree+0x1b0/0x2e0
    [    8.760327]        sysfs_get_tree+0x1f/0x60
    [    8.760329]        vfs_get_tree+0x2a/0xf0
    [    8.760332]        path_mount+0x4cd/0xc00
    [    8.760334]        __x64_sys_mount+0x119/0x150
    [    8.760336]        x64_sys_call+0x14f2/0x2310
    [    8.760338]        do_syscall_64+0x91/0x180
    [    8.760340]        entry_SYSCALL_64_after_hwframe+0x76/0x7e
    [    8.760342]
                   -> #0 (&root->kernfs_rwsem){++++}-{3:3}:
    [    8.760345]        __lock_acquire+0x1525/0x2760
    [    8.760347]        lock_acquire+0xca/0x310
    [    8.760348]        down_write+0x3e/0xf0
    [    8.760350]        kernfs_remove+0x32/0x60
    [    8.760351]        sysfs_remove_dir+0x4f/0x60
    [    8.760353]        __kobject_del+0x33/0xa0
    [    8.760355]        kobject_del+0x13/0x30
    [    8.760356]        elv_unregister_queue+0x52/0x80
    [    8.760358]        elevator_switch+0x68/0x360
    [    8.760360]        elv_iosched_store+0x14b/0x1b0
    [    8.760362]        queue_attr_store+0x181/0x1e0
    [    8.760364]        sysfs_kf_write+0x49/0x80
    [    8.760366]        kernfs_fop_write_iter+0x17d/0x250
    [    8.760367]        vfs_write+0x281/0x540
    [    8.760370]        ksys_write+0x72/0xf0
    [    8.760372]        __x64_sys_write+0x19/0x30
    [    8.760374]        x64_sys_call+0x2a3/0x2310
    [    8.760376]        do_syscall_64+0x91/0x180
    [    8.760377]        entry_SYSCALL_64_after_hwframe+0x76/0x7e
    [    8.760380]
                   other info that might help us debug this:
    
    [    8.760380] Chain exists of:
                     &root->kernfs_rwsem --> fs_reclaim --> &q->q_usage_counter(io)#27
    
    [    8.760384]  Possible unsafe locking scenario:
    
    [    8.760384]        CPU0                    CPU1
    [    8.760385]        ----                    ----
    [    8.760385]   lock(&q->q_usage_counter(io)#27);
    [    8.760387]                                lock(fs_reclaim);
    [    8.760388]                                lock(&q->q_usage_counter(io)#27);
    [    8.760390]   lock(&root->kernfs_rwsem);
    [    8.760391]
                    *** DEADLOCK ***
    
    [    8.760391] 6 locks held by (udev-worker)/674:
    [    8.760392]  #0: ffff8881209ac420 (sb_writers#4){.+.+}-{0:0}, at: ksys_write+0x72/0xf0
    [    8.760398]  #1: ffff88810c80f488 (&of->mutex#2){+.+.}-{3:3}, at: kernfs_fop_write_iter+0x136/0x250
    [    8.760402]  #2: ffff888125d1d330 (kn->active#101){.+.+}-{0:0}, at: kernfs_fop_write_iter+0x13f/0x250
    [    8.760406]  #3: ffff888110dc7bb0 (&q->sysfs_lock){+.+.}-{3:3}, at: queue_attr_store+0x148/0x1e0
    [    8.760411]  #4: ffff888110dc7680 (&q->q_usage_counter(io)#27){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x12/0x30
    [    8.760416]  #5: ffff888110dc76b8 (&q->q_usage_counter(queue)#27){++++}-{0:0}, at: blk_mq_freeze_queue_nomemsave+0x12/0x30
    [    8.760421]
                   stack backtrace:
    [    8.760422] CPU: 7 UID: 0 PID: 674 Comm: (udev-worker) Tainted: G     U             6.14.0-rc6-xe+ #7
    [    8.760424] Tainted: [U]=USER
    [    8.760425] Hardware name: ASUS System Product Name/PRIME B560M-A AC, BIOS 2001 02/01/2023
    [    8.760426] Call Trace:
    [    8.760427]  <TASK>
    [    8.760428]  dump_stack_lvl+0x6e/0xa0
    [    8.760431]  dump_stack+0x10/0x18
    [    8.760433]  print_circular_bug.cold+0x17a/0x1b7
    [    8.760437]  check_noncircular+0x13a/0x150
    [    8.760441]  ? save_trace+0x54/0x360
    [    8.760445]  __lock_acquire+0x1525/0x2760
    [    8.760446]  ? irqentry_exit+0x3a/0xb0
    [    8.760448]  ? sysvec_apic_timer_interrupt+0x57/0xc0
    [    8.760452]  lock_acquire+0xca/0x310
    [    8.760453]  ? kernfs_remove+0x32/0x60
    [    8.760457]  down_write+0x3e/0xf0
    [    8.760459]  ? kernfs_remove+0x32/0x60
    [    8.760460]  kernfs_remove+0x32/0x60
    [    8.760462]  sysfs_remove_dir+0x4f/0x60
    [    8.760464]  __kobject_del+0x33/0xa0
    [    8.760466]  kobject_del+0x13/0x30
    [    8.760467]  elv_unregister_queue+0x52/0x80
    [    8.760470]  elevator_switch+0x68/0x360
    [    8.760472]  elv_iosched_store+0x14b/0x1b0
    [    8.760475]  queue_attr_store+0x181/0x1e0
    [    8.760479]  ? lock_acquire+0xca/0x310
    [    8.760480]  ? kernfs_fop_write_iter+0x13f/0x250
    [    8.760482]  ? lock_is_held_type+0xa3/0x130
    [    8.760485]  sysfs_kf_write+0x49/0x80
    [    8.760487]  kernfs_fop_write_iter+0x17d/0x250
    [    8.760489]  vfs_write+0x281/0x540
    [    8.760494]  ksys_write+0x72/0xf0
    [    8.760497]  __x64_sys_write+0x19/0x30
    [    8.760499]  x64_sys_call+0x2a3/0x2310
    [    8.760502]  do_syscall_64+0x91/0x180
    [    8.760504]  ? trace_hardirqs_off+0x5d/0xe0
    [    8.760506]  ? handle_softirqs+0x479/0x4d0
    [    8.760508]  ? hrtimer_interrupt+0x13f/0x280
    [    8.760511]  ? irqentry_exit_to_user_mode+0x8b/0x260
    [    8.760513]  ? clear_bhb_loop+0x15/0x70
    [    8.760515]  ? clear_bhb_loop+0x15/0x70
    [    8.760516]  ? clear_bhb_loop+0x15/0x70
    [    8.760518]  entry_SYSCALL_64_after_hwframe+0x76/0x7e
    [    8.760520] RIP: 0033:0x7aa3bf2f5504
    [    8.760522] Code: c7 00 16 00 00 00 b8 ff ff ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 f3 0f 1e fa 80 3d c5 8b 10 00 00 74 13 b8 01 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 54 c3 0f 1f 00 55 48 89 e5 48 83 ec 20 48 89
    [    8.760523] RSP: 002b:00007ffc1e3697d8 EFLAGS: 00000202 ORIG_RAX: 0000000000000001
    [    8.760526] RAX: ffffffffffffffda RBX: 0000000000000003 RCX: 00007aa3bf2f5504
    [    8.760527] RDX: 0000000000000003 RSI: 00007ffc1e369ae0 RDI: 000000000000001c
    [    8.760528] RBP: 00007ffc1e369800 R08: 00007aa3bf3f51c8 R09: 00007ffc1e3698b0
    [    8.760528] R10: 0000000000000000 R11: 0000000000000202 R12: 0000000000000003
    [    8.760529] R13: 00007ffc1e369ae0 R14: 0000613ccf21f2f0 R15: 00007aa3bf3f4e80
    [    8.760533]  </TASK>
    
    v2:
    - Update a code comment to increase readability (Ming Lei).
    
    Cc: Jens Axboe <axboe@kernel.dk>
    Cc: linux-block@vger.kernel.org
    Cc: linux-kernel@vger.kernel.org
    Cc: Ming Lei <ming.lei@redhat.com>
    Signed-off-by: Thomas Hellström <thomas.hellstrom@linux.intel.com>
    Reviewed-by: Ming Lei <ming.lei@redhat.com>
    Link: https://lore.kernel.org/r/20250318095548.5187-1-thomas.hellstrom@linux.intel.com
    Signed-off-by: Jens Axboe <axboe@kernel.dk>

 block/blk-core.c | 6 ++++++
 1 file changed, 6 insertions(+)|
|0327_215521|cmd=git bisect log >> /var/www/html/bzimage/bi.log|
|0327_215521|cmd=git bisect log >> /var/www/html/bzimage/0327_170923_blk_mq_freeze_queue_nomemsave/bisect.log|
git bisect start
# status: waiting for both good and bad commits
# bad: [eb4bc4b07f66f01618d9cb1aa4eaef59b1188415] Add linux-next specific files for 20250325
git bisect bad eb4bc4b07f66f01618d9cb1aa4eaef59b1188415
# status: waiting for good commit(s), bad commit known
# good: [38fec10eb60d687e30c8c6b5420d86e8149f7557] Linux 6.14
git bisect good 38fec10eb60d687e30c8c6b5420d86e8149f7557
# good: [7fce4e72b3a632ef0571b6808743f7161eb381d5] Merge branch 'main' of git://git.kernel.org/pub/scm/linux/kernel/git/netdev/net-next.git
git bisect good 7fce4e72b3a632ef0571b6808743f7161eb381d5
# bad: [8447b0779f1aa7db55d5f249779ba8635aa856e7] Merge branch 'master' of git://www.linux-watchdog.org/linux-watchdog-next.git
git bisect bad 8447b0779f1aa7db55d5f249779ba8635aa856e7
# good: [52eb8cd788f1a56a0645c1f6650e5795e04aaed0] Merge drm/drm-next into drm-xe-next
git bisect good 52eb8cd788f1a56a0645c1f6650e5795e04aaed0
# good: [985b964c63502e64a45907baf838f98ef4c46660] Merge branch 'master' of git://git.kernel.org/pub/scm/linux/kernel/git/herbert/cryptodev-2.6.git
git bisect good 985b964c63502e64a45907baf838f98ef4c46660
# bad: [b3f9d748911e6839fe11e48c3a31270eadf7a297] Merge branch 'for-next' of git://git.kernel.dk/linux-block.git
git bisect bad b3f9d748911e6839fe11e48c3a31270eadf7a297
# bad: [95fb1ce9385b257bcf7bac1933b2d97270713c10] Merge branch 'for-6.15/io_uring' into for-next
git bisect bad 95fb1ce9385b257bcf7bac1933b2d97270713c10
# good: [5f14404bfa245a156915ee44c827edc56655b067] io_uring/cmd: don't expose entire cmd async data
git bisect good 5f14404bfa245a156915ee44c827edc56655b067
# good: [017ff379b60b98c17b82f878b4eb751dc99eb21c] Merge tag 'md-6.15-20250312' of https://git.kernel.org/pub/scm/linux/kernel/git/mdraid/linux into for-6.15/block
git bisect good 017ff379b60b98c17b82f878b4eb751dc99eb21c
# bad: [64ea88e3afa8c5b6c3f9c477da304b7a56149612] nvmet: replace max(a, min(b, c)) by clamp(val, lo, hi)
git bisect bad 64ea88e3afa8c5b6c3f9c477da304b7a56149612
# bad: [9d5c0fffee266f61ccc745faa6298dafe2b8c5bf] nvme: add nvme_auth_derive_tls_psk()
git bisect bad 9d5c0fffee266f61ccc745faa6298dafe2b8c5bf
# bad: [e1a0202c6bfda24002a3ae2115154fa90104c649] blk-cgroup: improve policy registration error handling
git bisect bad e1a0202c6bfda24002a3ae2115154fa90104c649
# good: [0e94ed33681424a6dce65c62837e08e4c7aa09ac] block: protect debugfs attribute method hctx_busy_show
git bisect good 0e94ed33681424a6dce65c62837e08e4c7aa09ac
# bad: [ffa1e7ada456087c2402b37cd6b2863ced29aff0] block: Make request_queue lockdep splats show up earlier
git bisect bad ffa1e7ada456087c2402b37cd6b2863ced29aff0
# good: [b0d42581195603f38184d7c130d0e2f43f40fb33] block: fix a comment in the queue_attrs[] array
git bisect good b0d42581195603f38184d7c130d0e2f43f40fb33
# first bad commit: [ffa1e7ada456087c2402b37cd6b2863ced29aff0] block: Make request_queue lockdep splats show up earlier
|0327_215521|nohup /root/bzimage_bisect/make_bz.sh -k /root/linux-next -m eb4bc4b07f66f01618d9cb1aa4eaef59b1188415 -b ffa1e7ada456087c2402b37cd6b2863ced29aff0 -d /var/www/html/bzimage -o /tmp/kernel -f /var/www/html/bzimage/bzImage_eb4bc4b07f66f01618d9cb1aa4eaef59b1188415_ffa1e7ada456087c2402b37cd6b2863ced29aff0_revert|
|0327_221628|1st base commit:38fec10eb60d687e30c8c6b5420d86e8149f7557!|
|0327_221628|/root/image/centos9_3.img -> /root/image/centos9_2.img|
|0327_221628|Run /var/www/html/bzimage/bzImage_eb4bc4b07f66f01618d9cb1aa4eaef59b1188415_ffa1e7ada456087c2402b37cd6b2863ced29aff0_revert with image:/root/image/centos9_2.img in local port:10022, 1 time|
|0327_221642|It takes 14 seconds to find login:test login: |
|0327_221642|Boot 1 time: takes 14 seconds to boot up.|
|0327_221642|cmd=ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'rm -rf file*'|
|0327_221643|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/bzimage_bisect/repro.sh root@localhost:/root/repro.sh|
|0327_221644|cmd=scp -o 'StrictHostKeyChecking no' -P 10022 /root/syzkaller/workdir/crashes/6ca073667b2d5081ea45c701046f6dec3af7e639/repro.cprog root@localhost:/root/repro.c|
|0327_221646|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost 'chmod 755 /root/repro.sh'|
|0327_221646|ssh -o ConnectTimeout=1 -o 'StrictHostKeyChecking no' -p 10022 localhost '/root/repro.sh'|
|0327_221729|/var/www/html/bzimage/bzImage_eb4bc4b07f66f01618d9cb1aa4eaef59b1188415_ffa1e7ada456087c2402b37cd6b2863ced29aff0_revert didn't contain blk_mq_freeze_queue_nomemsave: in dmesg, pass|
|0327_221729|Bisect successfully! eb4bc4b07f66f01618d9cb1aa4eaef59b1188415_ffa1e7ada456087c2402b37cd6b2863ced29aff0_revert bzimage passed!|
|0327_221729|cmd=cd /root/linux-next|
|0327_221729|ISSUE:6ca073667b2d5081ea45c701046f6dec3af7e639  EMAIL status after check:Email_not_sent|
