Extracting prog: 39.076007613s
Minimizing prog: 28m23.122902399s
Simplifying prog options: 0s
Extracting C: 28.806827925s
Simplifying C: 2m43.283650488s


extracting reproducer from 124 programs
first checking the prog from the crash report
single: executing 1 programs separately with timeout 30s
testing program (duration=30s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-openat$hpet-fcntl$lock-signalfd4-close-mprotect-getgroups-perf_event_open-mmap$IORING_OFF_SQ_RING-ioctl$PERF_EVENT_IOC_PAUSE_OUTPUT-syz_clone-openat$binfmt_register-write$binfmt_register
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100)={<r9=>0x0}, &(0x7f0000000180)=0xc) (async)
r10 = openat$hpet(0xffffffffffffff9c, &(0x7f0000000280), 0x101000, 0x0)
fcntl$lock(r10, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x20002, 0x6, r9}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x1]}, 0x8, 0x7d604017a6659d1b)
close(r8) (async)
mprotect(&(0x7f0000001000/0x1000)=nil, 0x1000, 0x5) (async)
getgroups(0xc, 0xfffffffffffffffe) (async)
r11 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r11, 0x0)
ioctl$PERF_EVENT_IOC_PAUSE_OUTPUT(r11, 0x40042409, 0x1)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)
r12 = openat$binfmt_register(0xffffffffffffff9c, &(0x7f00000001c0), 0x1, 0x0)
write$binfmt_register(r12, &(0x7f0000000200)={0x3a, 'syz0', 0x3a, 'M', 0x3a, 0xfffffffffffffffe, 0x3a, '%', 0x3a, 'ext4\x00', 0x3a, './file2'}, 0x2d)

program crashed: WARNING: locking bug in perf_event_wakeup
single: successfully extracted reproducer
found reproducer with 30 syscalls
minimizing guilty program
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-openat$hpet-fcntl$lock-signalfd4-close-mprotect-getgroups-perf_event_open-mmap$IORING_OFF_SQ_RING-ioctl$PERF_EVENT_IOC_PAUSE_OUTPUT-syz_clone-openat$binfmt_register
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100)={<r9=>0x0}, &(0x7f0000000180)=0xc) (async)
r10 = openat$hpet(0xffffffffffffff9c, &(0x7f0000000280), 0x101000, 0x0)
fcntl$lock(r10, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x20002, 0x6, r9}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x1]}, 0x8, 0x7d604017a6659d1b)
close(r8) (async)
mprotect(&(0x7f0000001000/0x1000)=nil, 0x1000, 0x5) (async)
getgroups(0xc, 0xfffffffffffffffe) (async)
r11 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r11, 0x0)
ioctl$PERF_EVENT_IOC_PAUSE_OUTPUT(r11, 0x40042409, 0x1)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)
openat$binfmt_register(0xffffffffffffff9c, &(0x7f00000001c0), 0x1, 0x0)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-openat$hpet-fcntl$lock-signalfd4-close-mprotect-getgroups-perf_event_open-mmap$IORING_OFF_SQ_RING-ioctl$PERF_EVENT_IOC_PAUSE_OUTPUT-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100)={<r9=>0x0}, &(0x7f0000000180)=0xc) (async)
r10 = openat$hpet(0xffffffffffffff9c, &(0x7f0000000280), 0x101000, 0x0)
fcntl$lock(r10, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x20002, 0x6, r9}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x1]}, 0x8, 0x7d604017a6659d1b)
close(r8) (async)
mprotect(&(0x7f0000001000/0x1000)=nil, 0x1000, 0x5) (async)
getgroups(0xc, 0xfffffffffffffffe) (async)
r11 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r11, 0x0)
ioctl$PERF_EVENT_IOC_PAUSE_OUTPUT(r11, 0x40042409, 0x1)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-openat$hpet-fcntl$lock-signalfd4-close-mprotect-getgroups-perf_event_open-mmap$IORING_OFF_SQ_RING-ioctl$PERF_EVENT_IOC_PAUSE_OUTPUT
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100)={<r9=>0x0}, &(0x7f0000000180)=0xc) (async)
r10 = openat$hpet(0xffffffffffffff9c, &(0x7f0000000280), 0x101000, 0x0)
fcntl$lock(r10, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x20002, 0x6, r9}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x1]}, 0x8, 0x7d604017a6659d1b)
close(r8) (async)
mprotect(&(0x7f0000001000/0x1000)=nil, 0x1000, 0x5) (async)
getgroups(0xc, 0xfffffffffffffffe) (async)
r11 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r11, 0x0)
ioctl$PERF_EVENT_IOC_PAUSE_OUTPUT(r11, 0x40042409, 0x1)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-openat$hpet-fcntl$lock-signalfd4-close-mprotect-getgroups-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100)={<r9=>0x0}, &(0x7f0000000180)=0xc) (async)
r10 = openat$hpet(0xffffffffffffff9c, &(0x7f0000000280), 0x101000, 0x0)
fcntl$lock(r10, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x20002, 0x6, r9}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x1]}, 0x8, 0x7d604017a6659d1b)
close(r8) (async)
mprotect(&(0x7f0000001000/0x1000)=nil, 0x1000, 0x5) (async)
getgroups(0xc, 0xfffffffffffffffe) (async)
r11 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r11, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-openat$hpet-fcntl$lock-signalfd4-close-mprotect-getgroups-perf_event_open-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100)={<r9=>0x0}, &(0x7f0000000180)=0xc) (async)
r10 = openat$hpet(0xffffffffffffff9c, &(0x7f0000000280), 0x101000, 0x0)
fcntl$lock(r10, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x20002, 0x6, r9}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x1]}, 0x8, 0x7d604017a6659d1b)
close(r8) (async)
mprotect(&(0x7f0000001000/0x1000)=nil, 0x1000, 0x5) (async)
getgroups(0xc, 0xfffffffffffffffe) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-openat$hpet-fcntl$lock-signalfd4-close-mprotect-getgroups-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100)={<r9=>0x0}, &(0x7f0000000180)=0xc) (async)
r10 = openat$hpet(0xffffffffffffff9c, &(0x7f0000000280), 0x101000, 0x0)
fcntl$lock(r10, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x20002, 0x6, r9}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x1]}, 0x8, 0x7d604017a6659d1b)
close(r8) (async)
mprotect(&(0x7f0000001000/0x1000)=nil, 0x1000, 0x5) (async)
getgroups(0xc, 0xfffffffffffffffe) (async)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, 0xffffffffffffffff, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-openat$hpet-fcntl$lock-signalfd4-close-mprotect-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100)={<r9=>0x0}, &(0x7f0000000180)=0xc) (async)
r10 = openat$hpet(0xffffffffffffff9c, &(0x7f0000000280), 0x101000, 0x0)
fcntl$lock(r10, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x20002, 0x6, r9}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x1]}, 0x8, 0x7d604017a6659d1b)
close(r8) (async)
mprotect(&(0x7f0000001000/0x1000)=nil, 0x1000, 0x5) (async)
r11 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r11, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-openat$hpet-fcntl$lock-signalfd4-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100)={<r9=>0x0}, &(0x7f0000000180)=0xc) (async)
r10 = openat$hpet(0xffffffffffffff9c, &(0x7f0000000280), 0x101000, 0x0)
fcntl$lock(r10, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x20002, 0x6, r9}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x1]}, 0x8, 0x7d604017a6659d1b)
close(r8) (async)
r11 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r11, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-openat$hpet-fcntl$lock-signalfd4-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100)={<r8=>0x0}, &(0x7f0000000180)=0xc) (async)
r9 = openat$hpet(0xffffffffffffff9c, &(0x7f0000000280), 0x101000, 0x0)
fcntl$lock(r9, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x20002, 0x6, r8}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x1]}, 0x8, 0x7d604017a6659d1b)
r10 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r10, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-openat$hpet-fcntl$lock-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100)={<r9=>0x0}, &(0x7f0000000180)=0xc) (async)
r10 = openat$hpet(0xffffffffffffff9c, &(0x7f0000000280), 0x101000, 0x0)
fcntl$lock(r10, 0x7, &(0x7f0000000000)={0x1, 0x0, 0x20002, 0x6, r9}) (async)
close(r8) (async)
r11 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r11, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-openat$hpet-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100), &(0x7f0000000180)=0xc) (async)
openat$hpet(0xffffffffffffff9c, &(0x7f0000000280), 0x101000, 0x0)
close(r8) (async)
r9 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r9, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-getsockopt$sock_cred-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
getsockopt$sock_cred(r5, 0x1, 0x11, &(0x7f0000000100), &(0x7f0000000180)=0xc) (async)
close(r8) (async)
r9 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r9, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
r8 = perf_event_open(&(0x7f0000000000)={0x4, 0x80, 0x4, 0x2, 0x2a, 0x8, 0x0, 0x3, 0x50004, 0xb, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x1, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x1, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, @perf_bp={0x0, 0x1}, 0x1084b0, 0x10000000008, 0x8fd4, 0x0, 0x9, 0x40003, 0x4, 0x0, 0xfffffffe, 0x0, 0x10000000ffffffff}, 0x0, 0xffffffffffffffff, r6, 0x1)
close(r8) (async)
r9 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r9, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-bpf$MAP_UPDATE_ELEM-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
r6 = dup3(r4, r5, 0x80000) (async)
r7 = bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
bpf$MAP_UPDATE_ELEM(0x2, &(0x7f0000000040)={r7, &(0x7f0000000100), &(0x7f0000000140)=@tcp=r6, 0x1}, 0x20)
close(0xffffffffffffffff) (async)
r8 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r8, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-bpf$MAP_CREATE_CONST_STR-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
dup3(r4, r5, 0x80000) (async)
bpf$MAP_CREATE_CONST_STR(0x0, &(0x7f0000000240)=ANY=[@ANYBLOB="12000000040100000800000001"], 0x48)
close(0xffffffffffffffff) (async)
r6 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r6, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-dup3-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480)={<r4=>0xffffffffffffffff, <r5=>0xffffffffffffffff})
dup3(r4, r5, 0x80000) (async)
close(0xffffffffffffffff) (async)
r6 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r6, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-socketpair$unix-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
socketpair$unix(0x1, 0x2, 0x0, &(0x7f0000000480))
close(0xffffffffffffffff) (async)
r4 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r4, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
close(0xffffffffffffffff) (async)
r4 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r4, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-bpf$PROG_LOAD-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
r3 = signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
bpf$PROG_LOAD(0x5, &(0x7f0000000380)={0xa, 0x30, &(0x7f00000007c0)=@ringbuf={{0x18, 0x0, 0x0, 0x0, 0x469, 0x0, 0x0, 0x0, 0xd0000000}, {{0x18, 0x1, 0x1, 0x0, r3}}, {}, [@snprintf={{}, {}, {0x7, 0x0, 0xb, 0x8, 0x0, 0x0, 0x4}, {}, {}, {}, {}, {}, {}, {0x18, 0x3, 0x2, 0x0, r3}}, @generic={0x1, 0x9, 0x2, 0x70, 0x4}, @map_fd={0x18, 0x9, 0x1, 0x0, r3}, @func={0x85, 0x0, 0x1, 0x0, 0xfffffffffffffff9}, @map_val={0x18, 0xb, 0x2, 0x0, r3, 0x0, 0x0, 0x0, 0x8}, @printk={@llu, {}, {}, {}, {}, {0x7, 0x0, 0xb, 0x3, 0x0, 0x0, 0x7}}, @map_idx_val={0x18, 0x3, 0x6, 0x0, 0x9, 0x0, 0x0, 0x0, 0x1}, @ringbuf_query], {{}, {}, {0x85, 0x0, 0x0, 0x84}}}, &(0x7f0000000340)='syzkaller\x00', 0x5, 0x0, 0x0, 0x41000, 0x61, '\x00', 0x0, @fallback=0x26, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xfffffffc, @void, @value}, 0x94) (async)
close(0xffffffffffffffff) (async)
r4 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r4, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-socket$inet6-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
socket$inet6(0xa, 0x2, 0x0) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
close(0xffffffffffffffff) (async)
r3 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r3, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-set_mempolicy-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
set_mempolicy(0x3, &(0x7f0000000000)=0x9, 0x3) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
close(0xffffffffffffffff) (async)
r3 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r3, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
close(0xffffffffffffffff) (async)
r3 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r3, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
close(0xffffffffffffffff) (async)
r3 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r3, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r2 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r2, 0x3b81, &(0x7f0000000000)={0xc}) (async)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
close(0xffffffffffffffff) (async)
r3 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r3, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
close(0xffffffffffffffff) (async)
r2 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r2, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0)={0x0, ""/256, 0x0, 0x0, 0x0, 0x0, ""/16, ""/16, ""/16, 0x0, 0x0, 0x0, <r1=>0x0})
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, r1, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
ioctl$IOMMU_IOAS_ALLOC(0xffffffffffffffff, 0x3b81, &(0x7f0000000000)={0xc}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
close(0xffffffffffffffff) (async)
r2 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r2, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_GET_SUBVOL_INFO-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
r0 = bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_GET_SUBVOL_INFO(r0, 0x81f8943c, &(0x7f00000004c0))
r1 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r1, 0x3b81, &(0x7f0000000000)={0xc}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
close(0xffffffffffffffff) (async)
r2 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r2, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-sched_getaffinity-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
sched_getaffinity(0x0, 0x8, &(0x7f0000000080)) (async)
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, 0x0, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r0 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r0, 0x3b81, &(0x7f0000000000)={0xc}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
close(0xffffffffffffffff) (async)
r1 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r1, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): bpf$PROG_LOAD-ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
bpf$PROG_LOAD(0x5, &(0x7f0000000940)={0xe, 0x4, &(0x7f0000000740)=@framed={{}, [@jmp={0x5, 0x0, 0xb, 0x0, 0x0, 0xfffffffffffffff4, 0x4}]}, &(0x7f0000000780)='GPL\x00', 0x0, 0x0, 0x0, 0x0, 0x3, '\x00', 0x0, @fallback=0x15, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x4, @void, @value}, 0x94)
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, 0x0, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r0 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r0, 0x3b81, &(0x7f0000000000)={0xc}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
close(0xffffffffffffffff) (async)
r1 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r1, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, 0x0, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r0 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r0, 0x3b81, &(0x7f0000000000)={0xc}) (async)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5) (async)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0) (async)
close(0xffffffffffffffff) (async)
r1 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r1, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0) (async)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, 0x0, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r0 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r0, 0x3b81, &(0x7f0000000000)={0xc})
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0)
close(0xffffffffffffffff)
r1 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r1, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0)

program crashed: WARNING: locking bug in perf_event_wakeup
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, 0x0)
r0 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r0, 0x3b81, &(0x7f0000000000)={0xc})
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0)
close(0xffffffffffffffff)
r1 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r1, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, 0x0, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r0 = openat$iommufd(0xffffffffffffff9c, 0x0, 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r0, 0x3b81, &(0x7f0000000000)={0xc})
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0)
close(0xffffffffffffffff)
r1 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r1, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, 0x0, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r0 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r0, 0x3b81, 0x0)
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0)
close(0xffffffffffffffff)
r1 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r1, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, 0x0, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r0 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r0, 0x3b81, &(0x7f0000000000)={0xc})
signalfd4(0xffffffffffffffff, 0x0, 0x0, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0)
close(0xffffffffffffffff)
r1 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r1, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, 0x0, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r0 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r0, 0x3b81, &(0x7f0000000000)={0xc})
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5)
perf_event_open(0x0, 0x0, 0x0, 0xffffffffffffffff, 0x0)
close(0xffffffffffffffff)
r1 = perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x0, 0x6b, 0x8, 0x4, 0x0, 0x10000, 0x0, 0x17, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4004, 0x2, @perf_config_ext={0x10001, 0xc527}, 0x12b8a, 0x2, 0x106, 0x9, 0x2, 0x2, 0xa2f4, 0x0, 0x4, 0x0, 0xffffffff00000000}, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r1, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0)

program did not crash
testing program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
detailed listing:
executing program 0:
ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL(0xffffffffffffffff, 0xc0c89425, &(0x7f0000000000)={"f245aafd7037db9b0118398a520cfe77", 0x0, 0x0, {0x3, 0x10000c}, {0x80000000000000, 0x4}, 0x9, [0xffffffffffffff80, 0x9, 0x1, 0x4, 0xa, 0x7, 0xfffffffffffffffd, 0x1, 0x3c, 0x7, 0x6, 0xba0, 0x4, 0x4f6edb63, 0xef, 0x5]})
r0 = openat$iommufd(0xffffffffffffff9c, &(0x7f0000000080), 0x0, 0x0)
ioctl$IOMMU_IOAS_ALLOC(r0, 0x3b81, &(0x7f0000000000)={0xc})
signalfd4(0xffffffffffffffff, &(0x7f0000000000)={[0x4]}, 0x8, 0x80800)
mprotect(&(0x7f0000000000/0x4000)=nil, 0x4000, 0x5)
perf_event_open(&(0x7f0000000000)={0x5, 0x80, 0x1, 0x6b, 0x4a, 0x1, 0x0, 0xfff, 0x24608, 0x7, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x1, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, 0x4, 0x4, @perf_config_ext={0xffffffff85ce8000, 0x401}, 0x12500, 0x6, 0x6, 0x7, 0x9, 0x7e, 0xa2f4, 0x0, 0x2, 0x0, 0x4}, 0x0, 0x0, 0xffffffffffffffff, 0x0)
close(0xffffffffffffffff)
r1 = perf_event_open(0x0, 0x0, 0x3ffffffff, 0xffffffffffffffff, 0x8)
mmap$IORING_OFF_SQ_RING(&(0x7f0000ffd000/0x3000)=nil, 0x3000, 0x1000003, 0x11, r1, 0x0)
syz_clone(0x82000, 0x0, 0x0, 0x0, 0x0, 0x0)

program did not crash
extracting C reproducer
testing compiled C program (duration=52.980707766s, {Threaded:true Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
program crashed: WARNING: locking bug in perf_event_wakeup
simplifying C reproducer
testing compiled C program (duration=52.980707766s, {Threaded:false Repeat:true RepeatTimes:0 Procs:8 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
program crashed: WARNING: locking bug in perf_event_wakeup
testing compiled C program (duration=52.980707766s, {Threaded:false Repeat:false RepeatTimes:0 Procs:1 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:false Cgroups:false BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
program did not crash
testing compiled C program (duration=52.980707766s, {Threaded:false Repeat:true RepeatTimes:0 Procs:1 Slowdown:1 Sandbox:none SandboxArg:0 Leak:false NetInjection:true NetDevices:true NetReset:true Cgroups:true BinfmtMisc:true CloseFDs:true KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:true UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
program crashed: WARNING: locking bug in perf_event_wakeup
testing compiled C program (duration=52.980707766s, {Threaded:false Repeat:true RepeatTimes:0 Procs:1 Slowdown:1 Sandbox: SandboxArg:0 Leak:false NetInjection:false NetDevices:false NetReset:false Cgroups:false BinfmtMisc:false CloseFDs:false KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:false UseTmpDir:true HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
program crashed: WARNING: locking bug in perf_event_wakeup
testing compiled C program (duration=52.980707766s, {Threaded:false Repeat:true RepeatTimes:0 Procs:1 Slowdown:1 Sandbox: SandboxArg:0 Leak:false NetInjection:false NetDevices:false NetReset:false Cgroups:false BinfmtMisc:false CloseFDs:false KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:false UseTmpDir:false HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
program crashed: WARNING: locking bug in perf_event_wakeup
testing compiled C program (duration=52.980707766s, {Threaded:false Repeat:true RepeatTimes:0 Procs:1 Slowdown:1 Sandbox: SandboxArg:0 Leak:false NetInjection:false NetDevices:false NetReset:false Cgroups:false BinfmtMisc:false CloseFDs:false KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:true Swap:false UseTmpDir:false HandleSegv:false Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
program did not crash
testing compiled C program (duration=52.980707766s, {Threaded:false Repeat:true RepeatTimes:0 Procs:1 Slowdown:1 Sandbox: SandboxArg:0 Leak:false NetInjection:false NetDevices:false NetReset:false Cgroups:false BinfmtMisc:false CloseFDs:false KCSAN:false DevlinkPCI:false NicVF:false USB:false VhciInjection:false Wifi:false IEEE802154:false Sysctl:false Swap:false UseTmpDir:false HandleSegv:true Trace:false LegacyOptions:{Collide:false Fault:false FaultCall:0 FaultNth:0}}): ioctl$BTRFS_IOC_SET_RECEIVED_SUBVOL-openat$iommufd-ioctl$IOMMU_IOAS_ALLOC-signalfd4-mprotect-perf_event_open-close-perf_event_open-mmap$IORING_OFF_SQ_RING-syz_clone
program crashed: WARNING: locking bug in perf_event_wakeup
reproducing took 32m14.289403176s
repro crashed as (corrupted=false):
=============================
[ BUG: Invalid wait context ]
6.15.0-2025-05-27-intel-next-5b0b0cae798e+ #1 Not tainted
-----------------------------
syz-executor311/770 is trying to lock:
ffff888025d5a5d0 (&event->waitq){....}-{3:3}, at: __wake_up_common_lock kernel/sched/wait.c:105 [inline]
ffff888025d5a5d0 (&event->waitq){....}-{3:3}, at: __wake_up+0x26/0x60 kernel/sched/wait.c:127
other info that might help us debug this:
context-{5:5}
4 locks held by syz-executor311/770:
 #0: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: rcu_lock_acquire include/linux/rcupdate.h:331 [inline]
 #0: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: rcu_read_lock include/linux/rcupdate.h:841 [inline]
 #0: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: perf_event_context_sched_in kernel/events/core.c:4182 [inline]
 #0: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: __perf_event_task_sched_in+0xd1/0xbc0 kernel/events/core.c:4249
 #1: ffff88806c43cb58 (&cpuctx_lock){....}-{2:2}, at: __perf_ctx_lock kernel/events/core.c:176 [inline]
 #1: ffff88806c43cb58 (&cpuctx_lock){....}-{2:2}, at: perf_ctx_lock kernel/events/core.c:183 [inline]
 #1: ffff88806c43cb58 (&cpuctx_lock){....}-{2:2}, at: perf_event_context_sched_in kernel/events/core.c:4198 [inline]
 #1: ffff88806c43cb58 (&cpuctx_lock){....}-{2:2}, at: __perf_event_task_sched_in+0x1a7/0xbc0 kernel/events/core.c:4249
 #2: ffff8880114e9818 (&ctx->lock){....}-{2:2}, at: __perf_ctx_lock kernel/events/core.c:176 [inline]
 #2: ffff8880114e9818 (&ctx->lock){....}-{2:2}, at: perf_ctx_lock kernel/events/core.c:185 [inline]
 #2: ffff8880114e9818 (&ctx->lock){....}-{2:2}, at: perf_event_context_sched_in kernel/events/core.c:4198 [inline]
 #2: ffff8880114e9818 (&ctx->lock){....}-{2:2}, at: __perf_event_task_sched_in+0x1f9/0xbc0 kernel/events/core.c:4249
 #3: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: rcu_lock_acquire include/linux/rcupdate.h:331 [inline]
 #3: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: rcu_read_lock include/linux/rcupdate.h:841 [inline]
 #3: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: ring_buffer_wakeup kernel/events/core.c:6915 [inline]
 #3: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: perf_event_wakeup+0x6c/0x470 kernel/events/core.c:7428
stack backtrace:
CPU: 0 UID: 0 PID: 770 Comm: syz-executor311 Not tainted 6.15.0-2025-05-27-intel-next-5b0b0cae798e+ #1 PREEMPT(voluntary) 
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.0-0-gd239552ce722-prebuilt.qemu.org 04/01/2014
Call Trace:
 <TASK>
 __dump_stack lib/dump_stack.c:94 [inline]
 dump_stack_lvl+0xea/0x150 lib/dump_stack.c:120
 dump_stack+0x19/0x20 lib/dump_stack.c:129
 print_lock_invalid_wait_context kernel/locking/lockdep.c:4831 [inline]
 check_wait_context kernel/locking/lockdep.c:4903 [inline]
 __lock_acquire+0xab3/0x2260 kernel/locking/lockdep.c:5185
 lock_acquire kernel/locking/lockdep.c:5866 [inline]
 lock_acquire+0x170/0x310 kernel/locking/lockdep.c:5823
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:110 [inline]
 _raw_spin_lock_irqsave+0x52/0x80 kernel/locking/spinlock.c:162
 __wake_up_common_lock kernel/sched/wait.c:105 [inline]
 __wake_up+0x26/0x60 kernel/sched/wait.c:127
 ring_buffer_wakeup kernel/events/core.c:6919 [inline]
 perf_event_wakeup+0x14a/0x470 kernel/events/core.c:7428
 merge_sched_in+0x9ef/0x1870 kernel/events/core.c:4072
 visit_groups_merge.constprop.0.isra.0+0x946/0x1410 kernel/events/core.c:3986
 pmu_groups_sched_in kernel/events/core.c:4094 [inline]
 __pmu_ctx_sched_in+0x16a/0x1f0 kernel/events/core.c:4104
 ctx_sched_in+0x668/0xcd0 kernel/events/core.c:4167
 perf_event_sched_in+0x56/0xa0 kernel/events/core.c:2892
 perf_event_context_sched_in kernel/events/core.c:4220 [inline]
 __perf_event_task_sched_in+0x3fe/0xbc0 kernel/events/core.c:4249
 perf_event_task_sched_in include/linux/perf_event.h:1607 [inline]
 finish_task_switch.isra.0+0x525/0x990 kernel/sched/core.c:5245
 context_switch kernel/sched/core.c:5385 [inline]
 __schedule+0xeed/0x37d0 kernel/sched/core.c:6767
 preempt_schedule_common+0x49/0xd0 kernel/sched/core.c:6947
 __cond_resched+0x37/0x50 kernel/sched/core.c:7292
 might_resched include/linux/kernel.h:73 [inline]
 might_alloc include/linux/sched/mm.h:321 [inline]
 might_alloc include/linux/sched/mm.h:316 [inline]
 slab_pre_alloc_hook mm/slub.c:4098 [inline]
 slab_alloc_node mm/slub.c:4176 [inline]
 kmem_cache_alloc_noprof+0x321/0x430 mm/slub.c:4203
 prepare_creds+0x38/0x7f0 kernel/cred.c:212
 copy_creds+0x84/0xa50 kernel/cred.c:312
 copy_process+0xe82/0x69d0 kernel/fork.c:2300
 kernel_clone+0xfc/0x8a0 kernel/fork.c:2851
 __do_sys_clone+0xf5/0x140 kernel/fork.c:2994
 __se_sys_clone kernel/fork.c:2978 [inline]
 __x64_sys_clone+0xc7/0x150 kernel/fork.c:2978
 x64_sys_call+0x1aca/0x2150 arch/x86/include/generated/asm/syscalls_64.h:57
 do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]
 do_syscall_64+0x6d/0x150 arch/x86/entry/syscall_64.c:94
 entry_SYSCALL_64_after_hwframe+0x76/0x7e
RIP: 0033:0x42187d
Code: 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 00 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
RSP: 002b:00007ffe093ab548 EFLAGS: 00000246 ORIG_RAX: 0000000000000038
RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 000000000042187d
RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000082000
RBP: 0000000000000000 R08: 0000000000000000 R09: 000000000000e3c0
R10: 0000000000000000 R11: 0000000000000246 R12: 431bde82d7b634db
R13: 00007ffe093ab7e8 R14: 00000000004b2e50 R15: 0000000000000001
 </TASK>
coredump: 792(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 817(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 804(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 798(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 839(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 837(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 878(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 884(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 903(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 943(syz-executor311): over core_pipe_limit, skipping core dump
do_coredump: 11 callbacks suppressed
coredump: 1115(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1119(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1146(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1217(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1184(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1153(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1151(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1187(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1192(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1231(syz-executor311): over core_pipe_limit, skipping core dump

final repro crashed as (corrupted=false):
=============================
[ BUG: Invalid wait context ]
6.15.0-2025-05-27-intel-next-5b0b0cae798e+ #1 Not tainted
-----------------------------
syz-executor311/770 is trying to lock:
ffff888025d5a5d0 (&event->waitq){....}-{3:3}, at: __wake_up_common_lock kernel/sched/wait.c:105 [inline]
ffff888025d5a5d0 (&event->waitq){....}-{3:3}, at: __wake_up+0x26/0x60 kernel/sched/wait.c:127
other info that might help us debug this:
context-{5:5}
4 locks held by syz-executor311/770:
 #0: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: rcu_lock_acquire include/linux/rcupdate.h:331 [inline]
 #0: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: rcu_read_lock include/linux/rcupdate.h:841 [inline]
 #0: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: perf_event_context_sched_in kernel/events/core.c:4182 [inline]
 #0: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: __perf_event_task_sched_in+0xd1/0xbc0 kernel/events/core.c:4249
 #1: ffff88806c43cb58 (&cpuctx_lock){....}-{2:2}, at: __perf_ctx_lock kernel/events/core.c:176 [inline]
 #1: ffff88806c43cb58 (&cpuctx_lock){....}-{2:2}, at: perf_ctx_lock kernel/events/core.c:183 [inline]
 #1: ffff88806c43cb58 (&cpuctx_lock){....}-{2:2}, at: perf_event_context_sched_in kernel/events/core.c:4198 [inline]
 #1: ffff88806c43cb58 (&cpuctx_lock){....}-{2:2}, at: __perf_event_task_sched_in+0x1a7/0xbc0 kernel/events/core.c:4249
 #2: ffff8880114e9818 (&ctx->lock){....}-{2:2}, at: __perf_ctx_lock kernel/events/core.c:176 [inline]
 #2: ffff8880114e9818 (&ctx->lock){....}-{2:2}, at: perf_ctx_lock kernel/events/core.c:185 [inline]
 #2: ffff8880114e9818 (&ctx->lock){....}-{2:2}, at: perf_event_context_sched_in kernel/events/core.c:4198 [inline]
 #2: ffff8880114e9818 (&ctx->lock){....}-{2:2}, at: __perf_event_task_sched_in+0x1f9/0xbc0 kernel/events/core.c:4249
 #3: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: rcu_lock_acquire include/linux/rcupdate.h:331 [inline]
 #3: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: rcu_read_lock include/linux/rcupdate.h:841 [inline]
 #3: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: ring_buffer_wakeup kernel/events/core.c:6915 [inline]
 #3: ffffffff87267900 (rcu_read_lock){....}-{1:3}, at: perf_event_wakeup+0x6c/0x470 kernel/events/core.c:7428
stack backtrace:
CPU: 0 UID: 0 PID: 770 Comm: syz-executor311 Not tainted 6.15.0-2025-05-27-intel-next-5b0b0cae798e+ #1 PREEMPT(voluntary) 
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.0-0-gd239552ce722-prebuilt.qemu.org 04/01/2014
Call Trace:
 <TASK>
 __dump_stack lib/dump_stack.c:94 [inline]
 dump_stack_lvl+0xea/0x150 lib/dump_stack.c:120
 dump_stack+0x19/0x20 lib/dump_stack.c:129
 print_lock_invalid_wait_context kernel/locking/lockdep.c:4831 [inline]
 check_wait_context kernel/locking/lockdep.c:4903 [inline]
 __lock_acquire+0xab3/0x2260 kernel/locking/lockdep.c:5185
 lock_acquire kernel/locking/lockdep.c:5866 [inline]
 lock_acquire+0x170/0x310 kernel/locking/lockdep.c:5823
 __raw_spin_lock_irqsave include/linux/spinlock_api_smp.h:110 [inline]
 _raw_spin_lock_irqsave+0x52/0x80 kernel/locking/spinlock.c:162
 __wake_up_common_lock kernel/sched/wait.c:105 [inline]
 __wake_up+0x26/0x60 kernel/sched/wait.c:127
 ring_buffer_wakeup kernel/events/core.c:6919 [inline]
 perf_event_wakeup+0x14a/0x470 kernel/events/core.c:7428
 merge_sched_in+0x9ef/0x1870 kernel/events/core.c:4072
 visit_groups_merge.constprop.0.isra.0+0x946/0x1410 kernel/events/core.c:3986
 pmu_groups_sched_in kernel/events/core.c:4094 [inline]
 __pmu_ctx_sched_in+0x16a/0x1f0 kernel/events/core.c:4104
 ctx_sched_in+0x668/0xcd0 kernel/events/core.c:4167
 perf_event_sched_in+0x56/0xa0 kernel/events/core.c:2892
 perf_event_context_sched_in kernel/events/core.c:4220 [inline]
 __perf_event_task_sched_in+0x3fe/0xbc0 kernel/events/core.c:4249
 perf_event_task_sched_in include/linux/perf_event.h:1607 [inline]
 finish_task_switch.isra.0+0x525/0x990 kernel/sched/core.c:5245
 context_switch kernel/sched/core.c:5385 [inline]
 __schedule+0xeed/0x37d0 kernel/sched/core.c:6767
 preempt_schedule_common+0x49/0xd0 kernel/sched/core.c:6947
 __cond_resched+0x37/0x50 kernel/sched/core.c:7292
 might_resched include/linux/kernel.h:73 [inline]
 might_alloc include/linux/sched/mm.h:321 [inline]
 might_alloc include/linux/sched/mm.h:316 [inline]
 slab_pre_alloc_hook mm/slub.c:4098 [inline]
 slab_alloc_node mm/slub.c:4176 [inline]
 kmem_cache_alloc_noprof+0x321/0x430 mm/slub.c:4203
 prepare_creds+0x38/0x7f0 kernel/cred.c:212
 copy_creds+0x84/0xa50 kernel/cred.c:312
 copy_process+0xe82/0x69d0 kernel/fork.c:2300
 kernel_clone+0xfc/0x8a0 kernel/fork.c:2851
 __do_sys_clone+0xf5/0x140 kernel/fork.c:2994
 __se_sys_clone kernel/fork.c:2978 [inline]
 __x64_sys_clone+0xc7/0x150 kernel/fork.c:2978
 x64_sys_call+0x1aca/0x2150 arch/x86/include/generated/asm/syscalls_64.h:57
 do_syscall_x64 arch/x86/entry/syscall_64.c:63 [inline]
 do_syscall_64+0x6d/0x150 arch/x86/entry/syscall_64.c:94
 entry_SYSCALL_64_after_hwframe+0x76/0x7e
RIP: 0033:0x42187d
Code: 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 00 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
RSP: 002b:00007ffe093ab548 EFLAGS: 00000246 ORIG_RAX: 0000000000000038
RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 000000000042187d
RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000082000
RBP: 0000000000000000 R08: 0000000000000000 R09: 000000000000e3c0
R10: 0000000000000000 R11: 0000000000000246 R12: 431bde82d7b634db
R13: 00007ffe093ab7e8 R14: 00000000004b2e50 R15: 0000000000000001
 </TASK>
coredump: 792(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 817(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 804(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 798(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 839(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 837(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 878(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 884(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 903(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 943(syz-executor311): over core_pipe_limit, skipping core dump
do_coredump: 11 callbacks suppressed
coredump: 1115(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1119(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1146(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1217(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1184(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1153(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1151(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1187(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1192(syz-executor311): over core_pipe_limit, skipping core dump
coredump: 1231(syz-executor311): over core_pipe_limit, skipping core dump

